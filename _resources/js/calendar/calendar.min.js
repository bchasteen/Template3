/**
* EITS Javascript Calendar for Twitter Boostrap v3.3.7
* Author Bryan Chasteen (chasteen at the University of Georgia)
* Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
*/
Date.prototype.dateFormat=function(t){LZ=function(t){return(0>t||t>9?"":"0")+t};var e,a=new Array("January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),n=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat"),i="",r=0,s="",d="",h=this.getFullYear().toString(),o=this.getMonth()+1,l=this.getDate(),c=this.getDay(),e=this.getHours(),u=this.getMinutes(),p=this.getSeconds(),m=[];for(m.Y=h.toString(),m.y=h.substring(2),m.n=o,m.m=LZ(o),m.F=a[o-1],m.M=a[o+11],m.j=l,m.d=LZ(l),m.D=n[c+7],m.l=n[c],m.G=e,m.H=LZ(e),m.g=0==e?12:e>12?e-12:e,m.h=m.g,e>11?(m.a="pm",m.A="PM"):(m.a="am",m.A="AM"),m.i=LZ(u),m.s=LZ(p),t=t?t+"":"m/d/Y";r<t.length;){for(s=t.charAt(r),d="";t.charAt(r)==s&&r<t.length;)d+=t.charAt(r++);i=null!=m[d]?i+m[d]:i+d}return i},Number.prototype.pad=function(t){for(var e=String(this);e.length<(t||2);)e="0"+e;return e};var Cal={init:function(t){if(t){var e,a,n=(this.getDisplayCategory(),this.getDisplayDate());this.config(t),this.monthDayCount=[31,(this.displayYearInitial-2e3)%4?28:29,31,30,31,30,31,31,30,31,30,31],this.calContainer&&this.draw(),this.calEvents&&(n?(a=this.events(n),e=new Date(n).dateFormat("F d, Y"),this.printEvents(this.eventsHTML(a),e)):this.printEvents(this.eventsHTML(this.initialEvents()),this.txtStartHeading))}},redirect:function(t){t="/"==t.substring(-1,1)?t+"/":t,window.location=t+window.location.hash},read:function(t,e){var a=new XMLHttpRequest;a.overrideMimeType("application/json"),a.open("GET",t,!0),a.onreadystatechange=function(){4==a.readyState&&"200"==a.status&&e(a.responseText)},a.send(null)},config:function(t){this.dateCurrent=new Date,this.dateTracker=new Date(this.dateCurrent.getFullYear(),this.dateCurrent.getMonth(),1),this.displayYearInitial=this.dateCurrent.getFullYear(),this.displayMonthInitial=this.dateCurrent.getMonth(),this.calContainer=t.hasOwnProperty("calendar")?t.calendar:0,this.calEvents=t.hasOwnProperty("events")?t.events:0,this.data=t.hasOwnProperty("data")?t.data:[],this.eventsRedirect=t.hasOwnProperty("eventsRedirect")?t.eventsRedirect:0,this.dayList=t.dayList?t.dayList:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.monthNames=t.monthNames?t.monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],this.monthUpTitle=t.monthUpTitle?t.monthUpTitle:"Go to the next month",this.monthDnTitle=t.monthDnTitle?t.monthDnTitle:"Go to the previous month",this.noEventsMsg=t.noEventsMsg?t.noEventsMsg:"No events to display",this.maxEvents=t.maxEvents?parseInt(t.maxEvents):999,this.txtFor=t.forText?t.forText:"for",this.txtCategory=t.categoryText?t.categoryText:"category",this.showPagination="undefined"!=typeof Pagination&&t.showPagination?t.showPagination:!1,this.showEventDesc=t.showEventDesc?this.parseBoolean(t.showEventDesc):!0,this.eventDescLength=t.eventDescLength?parseInt(t.eventDescLength):!1,this.showHeading=t.showHeading?this.parseBoolean(t.showHeading):!0,this.txtStartHeading=t.eventStartHeading?t.eventStartHeading:"Upcoming Events",this.dateStartEvents=t.eventStartDate&&!isNaN(t.eventStartDate.getTime())&&t.eventStartDate?t.eventStartDate:new Date,this.intNumDays=t.eventNumberOfDays?parseInt(t.eventNumberOfDays):7},draw:function(){this.calendar=document.createElement("div"),this.calendar.setAttribute("id","simple_calendar"),this.calendar.setAttribute("class","calendar"),this.calCellContainer=document.createElement("div"),this.calCellContainer.setAttribute("class","calendar-display"),this.calCellContainer.appendChild(this.days()),this.calendar.appendChild(this.controls()),this.calendar.appendChild(this.calCellContainer),this.calContainer&&this.calContainer.appendChild(this.calendar)},newEvent:function(t,e,a){return{title:t.title,description:t.description,author:t.author,category:t.category,link:t.link,image:t.image,pubDate:e,endDate:a}},categories:function(t,e){var a=[],n=this.dateStartEvents,i=(this.data,e.dateFormat("Y-m-d")),r="";n.setDate(n.getDate()+this.intNumDays),r=n.dateFormat("Y-m-d");for(var s in this.data){var d=Number.isInteger(this.data[s].pubDate)?new Date(1e3*this.data[s].pubDate):new Date(this.data[s].pubDate),h=this.data[s]&&this.data[s].hasOwnProperty("endDate")&&null!=this.data[s].endDate?Number.isInteger(this.data[s].pubDate)?new Date(1e3*this.data[s].endDate):new Date(this.data[s].endDate):null,o=d.dateFormat("Y-m-d"),l=h?h.dateFormat("Y-m-d"):null;for(var c in this.data[s].category)this.data[s].category[c]==t&&(o>=i&&r>=o||l>=i&&r>=l)&&a.push(this.newEvent(this.data[s],d,h))}return a.length?{events:a}:0},controls:function(){var t=this,e=document.createElement("div"),a=document.createElement("button"),n=document.createElement("button"),i=document.createElement("span"),r=document.createElement("span"),s=document.createTextNode(this.monthNames[this.displayMonthInitial]+" "+this.displayYearInitial);return this.ymDisplay=document.createElement("span"),this.ymDisplay.appendChild(s),this.ymDisplay.setAttribute("id","calendar-monthyear-title"),this.ymDisplay.setAttribute("tabindex","0"),this.ymDisplay.setAttribute("aria-label","Current Month"),i=document.createElement("span"),i.setAttribute("aria-hidden","true"),i.setAttribute("class","glyphicon glyphicon-triangle-left"),a.setAttribute("type","button"),a.setAttribute("title",this.monthDnTitle),a.setAttribute("class","btn btn-default prev-month"),a.setAttribute("aria-label","Previous Month"),a.appendChild(i),r.setAttribute("aria-hidden","true"),r.setAttribute("class","glyphicon glyphicon-triangle-right"),n.setAttribute("type","button"),n.setAttribute("title",this.monthUpTitle),n.setAttribute("class","btn btn-default next-month"),n.setAttribute("aria-label","Next Month"),n.appendChild(r),n.addEventListener("mouseup",function(e){t.dateTracker.setMonth(t.dateTracker.getMonth()+1),t.setMonth()}),a.addEventListener("mouseup",function(e){t.dateTracker.setMonth(t.dateTracker.getMonth()-1),t.setMonth()}),n.addEventListener("keypress",function(e){(13==e.charCode||32==e.charCode)&&(t.dateTracker.setMonth(t.dateTracker.getMonth()+1),t.setMonth())}),a.addEventListener("keypress",function(e){(13==e.charCode||32==e.charCode)&&(t.dateTracker.setMonth(t.dateTracker.getMonth()-1),t.setMonth())}),e.setAttribute("class","mainheading"),e.appendChild(a),e.appendChild(this.ymDisplay),e.appendChild(n),e},days:function(t){var e,a,n,i,r=this,s=new Date(this.dateTracker.getFullYear(),this.dateTracker.getMonth(),1),d=new Date(s),h=(document.createElement("caption"),0-s.getDay()),o=this.dateTracker.getMonth(),l="curr",c=new Date;this.calCells=document.createElement("table"),this.calCells.setAttribute("id",this.name+"_calcells"),this.calCells.setAttribute("class","table calendar-table table-bordered calcells"),d.setDate(d.getDate()+h-(h>0?7:0)),e=document.createElement("tbody"),a=document.createElement("tr");for(var u=0;7>u;u++)n=document.createElement("th"),n.appendChild(document.createTextNode(this.dayList[u])),a.appendChild(n);e.appendChild(a);for(var p=0;42>p;p++){if(p%7==0&&(a=document.createElement("tr")),n=document.createElement("td"),l=d.getMonth()<o?"prev":d.getMonth()>o?"next":"curr",n.setAttribute("class",d.dateFormat("Ymd")==c.dateFormat("Ymd")?"today":l),i=this.events(d)){var m=document.createElement("a");m.setAttribute("id",i.id),m.setAttribute("href",i.link),m.setAttribute("data-display",i.YYYYMMDD),m.appendChild(document.createTextNode(i.text)),m.addEventListener("click",function(t){var e=new Date(this.getAttribute("data-display")),a=r.events(e),n=new Date(e).dateFormat("F d, Y");if(r.eventsRedirect){t.preventDefault();var i=r.eventsRedirect+this.getAttribute("href").replace(".","");window.location=i.replace("//","/")}else r.calEvents.removeChild(r.calEvents.firstChild),r.printEvents(r.eventsHTML(a),n),document.getElementById("calendar-displayed-anchor").focus(),t.preventDefault();return!1}),n.appendChild(m)}else n.appendChild(document.createTextNode(d.getDate()));d.setDate(d.getDate()+1),a.appendChild(n),e.appendChild(a)}return this.calCells.appendChild(e),this.calCells},deleteCells:function(){this.calCellContainer.removeChild(this.calCellContainer.firstChild)},events:function(t){var e=[],a=t.dateFormat("Y-m-d");for(var n in this.data){var i=Number.isInteger(this.data[n].pubDate)?new Date(1e3*this.data[n].pubDate):new Date(this.data[n].pubDate),r=this.data[n]&&this.data[n].hasOwnProperty("endDate")&&null!=this.data[n].endDate?Number.isInteger(this.data[n].pubDate)?new Date(1e3*this.data[n].endDate):new Date(this.data[n].endDate):null,s=i.dateFormat("Y-m-d"),d=r?r.dateFormat("Y-m-d"):null;(a==s||d&&a>=s&&d>=a)&&e.push(this.newEvent(this.data[n],i,r))}return e.length?{id:"day-"+t.dateFormat("Y/m/d"),link:"#/"+t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate(),text:t.getDate(),YYYYMMDD:t.dateFormat("Y/m/d"),events:e}:0},eventsHTML:function(t){var e=this,a=[];document.createElement("ul");if(!t.events){var n=document.createElement("div"),r=document.createElement("h3");return r.appendChild(document.createTextNode(this.noEventsMsg)),n.appendChild(r),a.push(n),a}for(i in t.events){var s=t.events[i].pubDate,d="";if(t.events[i].endDate&&null!=t.events[i].endDate){var h=t.events[i].endDate,o=h.dateFormat("Y-m-d")==s.dateFormat("Y-m-d")?"h:i a":"F d, Y h:i a";d+=" - "+h.dateFormat(o)}var l=document.createElement("li"),c=document.createElement("h4"),u=document.createElement("p"),p=document.createElement("a"),m=document.createElement("strong");if(p.setAttribute("href",t.events[i].link),p.appendChild(document.createTextNode(t.events[i].title)),c.appendChild(p),m.appendChild(document.createTextNode(s.dateFormat("F d, Y h:i a")+d)),l.appendChild(c),l.appendChild(m),this.showEventDesc){var v=document.createElement("a");v.setAttribute("href",t.events[i].link),v.appendChild(document.createElement("br")),v.appendChild(document.createTextNode("Read more"));var g=this.eventDescLength?this.shortenString(t.events[i].description,this.eventDescLength):t.events[i].description;u.appendChild(document.createTextNode(g)),Boolean(this.eventDescLength)&&u.appendChild(v),l.appendChild(u)}if(t.events[i].category){catBox=document.createElement("p"),catBox.setAttribute("class","calendar-event-category");for(var D in t.events[i].category){var y=document.createElement("a");y.setAttribute("role","button"),y.setAttribute("class","btn btn-primary btn-sm"),y.setAttribute("href","#/category/"+t.events[i].category[D]),y.setAttribute("data-fromDate",t.events[i].pubDate),y.appendChild(document.createTextNode(t.events[i].category[D])),y.addEventListener("click",function(t){if(e.eventsRedirect){var a=e.eventsRedirect+this.getAttribute("href").replace(".","");window.location=a.replace("//","/")}else{var n=new Date(this.getAttribute("data-fromDate"));e.calEvents.removeChild(e.calEvents.firstChild),e.printEvents(e.eventsHTML(e.categories(this.innerHTML,n)),e.txtStartHeading+" "+e.txtFor+" "+e.txtCategory+": "+this.innerHTML),document.getElementById("calendar-displayed-anchor").focus()}t.preventDefault()}),catBox.appendChild(y),catBox.appendChild(document.createTextNode(" "))}}l.appendChild(catBox),a[i]=l}return a},getDisplayCategory:function(t){var e=/\/category\/([\w]+)[^\/]?/;return findCategory=t?t.match(e):this.getURLHash().match(e),findCategory?findCategory[1]:0},getDisplayDate:function(t){var e=/\d{4,4}\/\d{1,}\/\d{1,}/,a=t?t.match(e):this.getURLHash().match(e);return a?new Date(a):0},getURLHash:function(){return window.location.hash?window.location.hash.match(/#\/(.*)/)[1]:""},initialEvents:function(){var t=[],e=this.dateStartEvents,a=this.dateStartEvents.dateFormat("Y-m-d"),n="";e.setDate(e.getDate()+this.intNumDays),n=e.dateFormat("Y-m-d");for(var i in this.data){var r=Number.isInteger(this.data[i].pubDate)?new Date(1e3*this.data[i].pubDate):new Date(this.data[i].pubDate),s=this.data[i]&&this.data[i].hasOwnProperty("endDate")&&null!=this.data[i].endDate?Number.isInteger(this.data[i].pubDate)?new Date(1e3*this.data[i].endDate):new Date(this.data[i].endDate):null,d=r.dateFormat("Y-m-d"),h=s?s.dateFormat("Y-m-d"):null;(d>=a&&n>=d||h>=a&&n>=h)&&t.push(this.newEvent(this.data[i],r,s))}return t.length?{events:t}:0},pagination:function(t,e){var a=document.createElement("div");a.setAttribute("id","calendar-pagination"),Pagination.init({heading:t,data:e,maxEvents:this.maxEvents,target:a}),this.calEvents.appendChild(Pagination.target)},parseBoolean:function(t){return t===!0||"true"===t},printEvents:function(t,e){var a=document.createElement("ul"),n=document.createElement("h3"),i=document.createElement("a");if(a.setAttribute("class","calendar-event list-unstyled"),i.appendChild(document.createTextNode(e)),i.setAttribute("id","calendar-displayed-anchor"),i.setAttribute("href","./#/"),i.setAttribute("aria-label",e==this.txtStartHeading?e:this.txtStartHeading+" "+this.textFor+" "+e),n.setAttribute("id","calendar-displayed-heading"),n.appendChild(i),this.calEvents)if(this.showPagination)this.pagination(this.showHeading?n:!1,t);else{for(;this.calEvents.firstChild;)this.calEvents.removeChild(this.calEvents.firstChild);for(var r=0;r<t.length&&r<this.maxEvents;r++)t[r]&&a.appendChild(t[r]);this.showHeading&&this.calEvents.appendChild(n),this.calEvents.appendChild(a)}},setMonth:function(t){this.ymDisplay.innerHTML=this.monthNames[parseInt(this.dateTracker.getMonth())]+" "+this.dateTracker.getFullYear(),this.ymDisplay.focus(),this.deleteCells(),this.calCellContainer.appendChild(this.days())},shortenString:function(t,e){var a=t.substr(0,e);return a.substr(0,Math.min(a.length,a.lastIndexOf(" ")))+"..."}};